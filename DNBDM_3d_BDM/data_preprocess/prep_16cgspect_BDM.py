import os
import os.path as osp
import argparse
import numpy as np
from natsort import natsorted
from glob import glob
import tifffile as tiff  # 导入 tifffile 库来读取多帧 .tif 文件


def save_dataset(args):
    if not osp.exists(args.save_path):
        os.makedirs(args.save_path)
        print('Create path : {}'.format(args.save_path))
    patient_ids = [
        'P001', 'P002', 'P003', 'P004', 'P005', 'P006', 'P007', 'P008', 'P009', 'P010',
        'P011', 'P012', 'P013', 'P014', 'P015', 'P016', 'P017', 'P018', 'P019', 'P020',
        'P021', 'P022', 'P023', 'P024', 'P025', 'P026', 'P027', 'P028', 'P029', 'P030',
        'P031', 'P032', 'P033', 'P034', 'P035', 'P036', 'P037', 'P038', 'P039', 'P040',
        'P041', 'P042', 'P043', 'P044', 'P045', 'P046', 'P047', 'P048', 'P049', 'P050',
        'P051', 'P052', 'P053', 'P054', 'P055', 'P056', 'P057', 'P058', 'P059', 'P060',
        'P061', 'P062', 'P063', 'P064', 'P065', 'P066', 'P067', 'P068', 'P069', 'P070',
        'P071', 'P072', 'P073', 'P074', 'P075', 'P076', 'P077', 'P078', 'P079', 'P080',
        'P081', 'P082', 'P083', 'P084', 'P085', 'P086', 'P087', 'P088', 'P089', 'P090',
        'P091', 'P092', 'P093', 'P094', 'P095', 'P096', 'P097', 'P098', 'P099', 'P100',
        'P101', 'P102', 'P103', 'P104', 'P105', 'P106', 'P107', 'P108', 'P109', 'P110',
        'P111', 'P112', 'P113', 'P114', 'P115', 'P116', 'P117', 'P118', 'P119', 'P120',
        'P121', 'P122', 'P123', 'P124', 'P125', 'P126', 'P127', 'P128', 'P129', 'P130',
        'P131', 'P132', 'P133', 'P134', 'P135', 'P136', 'P137', 'P138', 'P139', 'P140',
        'P141', 'P142', 'P143', 'P144', 'P145', 'P146', 'P147', 'P148', 'P149', 'P150',
        'P151', 'P152', 'P153', 'P154', 'P155', 'P156', 'P157', 'P158', 'P159', 'P160',
        'P161', 'P162', 'P163', 'P164', 'P165', 'P166', 'P167', 'P168', 'P169', 'P170',
        'P171', 'P172', 'P173', 'P174', 'P175', 'P176', 'P177', 'P178', 'P179', 'P180',
        'P181', 'P182', 'P183', 'P184', 'P185', 'P186', 'P187', 'P188', 'P189', 'P190',
        'P191', 'P192', 'P193', 'P194', 'P195', 'P196', 'P197', 'P198', 'P199', 'P200',
        'P201', 'P202', 'P203', 'P204', 'P205', 'P206', 'P207', 'P208', 'P209', 'P210',
        'P211', 'P212', 'P213', 'P214', 'P215', 'P216', 'P217', 'P218', 'P219', 'P220',
        'P221', 'P222', 'P223', 'P224', 'P225', 'P226', 'P227', 'P228', 'P229', 'P230',
        'P231', 'P232', 'P233', 'P234', 'P235', 'P236', 'P237', 'P238', 'P239', 'P240',
        'P241', 'P242', 'P243', 'P244', 'P245', 'P246', 'P247', 'P248', 'P249', 'P250',
        'P251', 'P252', 'P253', 'P254', 'P255', 'P256', 'P257', 'P258', 'P259', 'P260',
        'P261', 'P262', 'P263', 'P264', 'P265', 'P266', 'P267', 'P268', 'P269', 'P270',
        'P271', 'P272', 'P273', 'P274', 'P275', 'P276', 'P277', 'P278', 'P279', 'P280',
        'P281', 'P282', 'P283', 'P284', 'P285', 'P286', 'P287', 'P288', 'P289', 'P290',
        'P291', 'P292', 'P293', 'P294', 'P295', 'P296', 'P297', 'P298', 'P299', 'P300',
        'P301', 'P302', 'P303', 'P304', 'P305', 'P306', 'P307', 'P308', 'P309', 'P310',
        'P311', 'P312', 'P313', 'P314', 'P315', 'P316', 'P317', 'P318', 'P319', 'P320',
        'P321', 'P322', 'P323', 'P324', 'P325', 'P326', 'P327', 'P328', 'P329', 'P330',
        'P331', 'P332', 'P333', 'P334', 'P335', 'P336', 'P337', 'P338', 'P339', 'P340',
        'P341', 'P342', 'P343', 'P344', 'P345', 'P346', 'P347', 'P348', 'P349', 'P350',
        'P351', 'P352', 'P353', 'P354', 'P355', 'P356', 'P357', 'P358', 'P359', 'P360',
        'P361', 'P362', 'P363', 'P364', 'P365', 'P366', 'P367', 'P368', 'P369', 'P370',
        'P371', 'P372', 'P373', 'P374', 'P375', 'P376', 'P377', 'P378', 'P379', 'P380',
        'P381', 'P382', 'P383', 'P384', 'P385', 'P386', 'P387', 'P388', 'P389', 'P390',
        'P391', 'P392', 'P393', 'P394', 'P395', 'P396', 'P397', 'P398', 'P399', 'P400',
        'P401', 'P402', 'P403', 'P404', 'P405', 'P406', 'P407', 'P408', 'P409', 'P410',
        'P411', 'P412', 'P413', 'P414', 'P415', 'P416', 'P417', 'P418', 'P419', 'P420',
        'P421', 'P422', 'P423', 'P424', 'P425', 'P426', 'P427', 'P428', 'P429', 'P430',
        'P431', 'P432', 'P433', 'P434', 'P435', 'P436', 'P437', 'P438', 'P439', 'P440',
        'P441', 'P442', 'P443', 'P444', 'P445', 'P446', 'P447', 'P448', 'P449', 'P450',
        'P451', 'P452', 'P453', 'P454', 'P455', 'P456', 'P457', 'P458', 'P459', 'P460',
        'P461', 'P462', 'P463', 'P464', 'P465', 'P466', 'P467', 'P468', 'P469', 'P470',
        'P471', 'P472', 'P473', 'P474', 'P475', 'P476', 'P477', 'P478', 'P479', 'P480',
        'P481', 'P482', 'P483', 'P484', 'P485', 'P486', 'P487', 'P488', 'P489', 'P490',
        'P491', 'P492', 'P493', 'P494', 'P495', 'P496', 'P497', 'P498', 'P499', 'P500',
        'P501', 'P502', 'P503', 'P504', 'P505', 'P506', 'P507', 'P508', 'P509', 'P510',
        'P511', 'P512', 'P513', 'P514', 'P515', 'P516', 'P517', 'P518', 'P519', 'P520',
        'P521', 'P522', 'P523', 'P524', 'P525', 'P526', 'P527', 'P528', 'P529', 'P530',
        'P531', 'P532', 'P533', 'P534', 'P535', 'P536', 'P537', 'P538', 'P539', 'P540',
        'P541', 'P542', 'P543', 'P544', 'P545', 'P546', 'P547', 'P548', 'P549', 'P550',
        'P551', 'P552', 'P553', 'P554', 'P555', 'P556', 'P557', 'P558', 'P559', 'P560',
        'P561', 'P562', 'P563', 'P564', 'P565', 'P566', 'P567', 'P568', 'P569', 'P570',
        'P571', 'P572', 'P573', 'P574', 'P575', 'P576', 'P577', 'P578', 'P579', 'P580',
        'P581', 'P582', 'P583', 'P584', 'P585', 'P586', 'P587', 'P588', 'P589', 'P590',
        'P591', 'P592', 'P593', 'P594', 'P595', 'P596', 'P597', 'P598', 'P599', 'P600',
        'P601', 'P602', 'P603', 'P604', 'P605', 'P606', 'P607', 'P608', 'P609', 'P610',
        'P611', 'P612', 'P613', 'P614', 'P615', 'P616', 'P617', 'P618', 'P619', 'P620',
        'P621', 'P622', 'P623', 'P624', 'P625', 'P626', 'P627', 'P628', 'P629', 'P630',
        'P631', 'P632', 'P633', 'P634', 'P635', 'P636', 'P637', 'P638', 'P639', 'P640',
        'P641', 'P642', 'P643', 'P644', 'P645', 'P646', 'P647', 'P648', 'P649', 'P650',
        'P651', 'P652', 'P653', 'P654', 'P655', 'P656', 'P657', 'P658', 'P659', 'P660',
        'P661', 'P662', 'P663', 'P664', 'P665', 'P666', 'P667', 'P668', 'P669', 'P670',
        'P671', 'P672', 'P673', 'P674', 'P675', 'P676', 'P677', 'P678', 'P679', 'P680',
        'P681', 'P682', 'P683', 'P684', 'P685', 'P686', 'P687', 'P688', 'P689', 'P690',
        'P691', 'P692', 'P693', 'P694', 'P695', 'P696', 'P697', 'P698', 'P699', 'P700',
        'P701', 'P702', 'P703', 'P704', 'P705', 'P706', 'P707', 'P708', 'P709', 'P710',
        'P711', 'P712', 'P713', 'P714', 'P715', 'P716', 'P717', 'P718', 'P719', 'P720',
        'P721', 'P722', 'P723', 'P724', 'P725', 'P726', 'P727', 'P728', 'P729', 'P730',
        'P731', 'P732', 'P733', 'P734', 'P735', 'P736', 'P737', 'P738', 'P739', 'P740',
        'P741', 'P742', 'P743', 'P744', 'P745', 'P746', 'P747', 'P748', 'P749', 'P750',
        'P751', 'P752', 'P753', 'P754', 'P755', 'P756', 'P757', 'P758', 'P759', 'P760',
        'P761', 'P762', 'P763', 'P764', 'P765', 'P766', 'P767', 'P768', 'P769', 'P770',
        'P771', 'P772', 'P773', 'P774', 'P775', 'P776', 'P777', 'P778', 'P779', 'P780',
        'P781', 'P782', 'P783', 'P784', 'P785', 'P786', 'P787', 'P788', 'P789', 'P790',
        'P791', 'P792', 'P793', 'P794', 'P795', 'P796', 'P797', 'P798', 'P799', 'P800',
        'P801', 'P802', 'P803', 'P804', 'P805', 'P806', 'P807', 'P808', 'P809', 'P810',
        'P811', 'P812', 'P813', 'P814', 'P815', 'P816', 'P817', 'P818', 'P819', 'P820',
        'P821', 'P822', 'P823', 'P824', 'P825', 'P826', 'P827', 'P828', 'P829', 'P830',
        'P831', 'P832', 'P833', 'P834', 'P835', 'P836', 'P837', 'P838', 'P839', 'P840',
        'P841', 'P842', 'P843', 'P844', 'P845', 'P846', 'P847', 'P848', 'P849', 'P850',
        'P851', 'P852', 'P853', 'P854', 'P855', 'P856', 'P857', 'P858', 'P859', 'P860',
        'P861', 'P862', 'P863', 'P864', 'P865', 'P866', 'P867', 'P868', 'P869', 'P870',
        'P871', 'P872', 'P873', 'P874', 'P875', 'P876', 'P877', 'P878', 'P879', 'P880',
        'P881', 'P882', 'P883', 'P884', 'P885', 'P886', 'P887', 'P888', 'P889', 'P890',
        'P891', 'P892', 'P893', 'P894', 'P895', 'P896', 'P897', 'P898', 'P899', 'P900',
        'P901', 'P902', 'P903', 'P904', 'P905', 'P906', 'P907', 'P908', 'P909', 'P910',
        'P911', 'P912', 'P913', 'P914', 'P915', 'P916', 'P917', 'P918', 'P919', 'P920',
        'P921', 'P922', 'P923', 'P924', 'P925', 'P926', 'P927', 'P928', 'P929', 'P930',
        'P931', 'P932', 'P933', 'P934', 'P935', 'P936', 'P937', 'P938', 'P939', 'P940',
        'P941', 'P942', 'P943', 'P944', 'P945', 'P946', 'P947', 'P948', 'P949', 'P950',
        'P951', 'P952', 'P953', 'P954', 'P955', 'P956', 'P957', 'P958', 'P959', 'P960',
        'P961', 'P962', 'P963', 'P964', 'P965', 'P966', 'P967', 'P968', 'P969', 'P970',
        'P971', 'P972', 'P973', 'P974', 'P975', 'P976', 'P977', 'P978', 'P979', 'P980',
        'P981', 'P982', 'P983', 'P984', 'P985', 'P986', 'P987', 'P988', 'P989', 'P990',
        'P991', 'P992', 'P993', 'P994', 'P995', 'P996', 'P997', 'P998', 'P999', 'P1000',
        'P1001', 'P1002', 'P1003', 'P1004', 'P1005', 'P1006', 'P1007', 'P1008', 'P1009', 'P1010',
        'P1011', 'P1012', 'P1013', 'P1014', 'P1015', 'P1016', 'P1017', 'P1018', 'P1019', 'P1020',
        'P1021', 'P1022', 'P1023', 'P1024', 'P1025', 'P1026', 'P1027', 'P1028', 'P1029', 'P1030',
        'P1031', 'P1032', 'P1033', 'P1034', 'P1035', 'P1036', 'P1037', 'P1038', 'P1039', 'P1040',
        'P1041', 'P1042', 'P1043', 'P1044', 'P1045', 'P1046', 'P1047', 'P1048', 'P1049', 'P1050',
        'P1051', 'P1052', 'P1053', 'P1054', 'P1055', 'P1056', 'P1057', 'P1058', 'P1059', 'P1060',
        'P1061', 'P1062', 'P1063', 'P1064', 'P1065', 'P1066', 'P1067', 'P1068', 'P1069', 'P1070',
        'P1071', 'P1072', 'P1073', 'P1074', 'P1075', 'P1076', 'P1077', 'P1078', 'P1079', 'P1080',
        'P1081', 'P1082', 'P1083', 'P1084', 'P1085', 'P1086', 'P1087', 'P1088', 'P1089', 'P1090',
        'P1091', 'P1092', 'P1093', 'P1094', 'P1095', 'P1096', 'P1097', 'P1098', 'P1099', 'P1100',
        'P1101', 'P1102', 'P1103', 'P1104', 'P1105', 'P1106', 'P1107', 'P1108', 'P1109', 'P1110',
        'P1111', 'P1112', 'P1113', 'P1114', 'P1115', 'P1116', 'P1117', 'P1118', 'P1119', 'P1120',
        'P1121', 'P1122', 'P1123', 'P1124', 'P1125', 'P1126', 'P1127', 'P1128', 'P1129', 'P1130',
        'P1131', 'P1132', 'P1133', 'P1134', 'P1135', 'P1136', 'P1137', 'P1138', 'P1139', 'P1140',
        'P1141', 'P1142', 'P1143', 'P1144', 'P1145', 'P1146', 'P1147', 'P1148', 'P1149', 'P1150',
        'P1151', 'P1152', 'P1153', 'P1154', 'P1155', 'P1156', 'P1157', 'P1158', 'P1159', 'P1160',
        'P1161', 'P1162', 'P1163', 'P1164', 'P1165', 'P1166', 'P1167', 'P1168', 'P1169', 'P1170',
        'P1171', 'P1172', 'P1173', 'P1174', 'P1175', 'P1176', 'P1177', 'P1178', 'P1179', 'P1180',
        'P1181', 'P1182', 'P1183', 'P1184', 'P1185', 'P1186', 'P1187', 'P1188', 'P1189', 'P1190',
        'P1191', 'P1192', 'P1193', 'P1194', 'P1195', 'P1196', 'P1197', 'P1198', 'P1199', 'P1200',
        'P1201', 'P1202', 'P1203', 'P1204', 'P1205', 'P1206', 'P1207', 'P1208', 'P1209', 'P1210',
        'P1211', 'P1212', 'P1213', 'P1214', 'P1215', 'P1216', 'P1217', 'P1218', 'P1219', 'P1220',
        'P1221', 'P1222', 'P1223', 'P1224', 'P1225', 'P1226', 'P1227', 'P1228', 'P1229', 'P1230',
        'P1231', 'P1232', 'P1233', 'P1234', 'P1235', 'P1236', 'P1237', 'P1238', 'P1239', 'P1240',
        'P1241', 'P1242', 'P1243', 'P1244', 'P1245', 'P1246', 'P1247', 'P1248', 'P1249', 'P1250',
        'P1251', 'P1252', 'P1253', 'P1254', 'P1255', 'P1256', 'P1257', 'P1258', 'P1259', 'P1260',
        'P1261', 'P1262', 'P1263', 'P1264', 'P1265', 'P1266', 'P1267', 'P1268', 'P1269', 'P1270',
        'P1271', 'P1272', 'P1273', 'P1274', 'P1275', 'P1276', 'P1277', 'P1278', 'P1279', 'P1280',
        'P1281', 'P1282', 'P1283', 'P1284', 'P1285', 'P1286', 'P1287', 'P1288', 'P1289', 'P1290',
        'P1291', 'P1292', 'P1293', 'P1294', 'P1295', 'P1296', 'P1297', 'P1298', 'P1299', 'P1300',
        'P1301', 'P1302', 'P1303', 'P1304', 'P1305', 'P1306', 'P1307', 'P1308', 'P1309', 'P1310',
        'P1311', 'P1312', 'P1313', 'P1314', 'P1315', 'P1316', 'P1317', 'P1318', 'P1319', 'P1320',
        'P1321', 'P1322', 'P1323', 'P1324', 'P1325', 'P1326', 'P1327', 'P1328', 'P1329', 'P1330',
        'P1331', 'P1332', 'P1333', 'P1334', 'P1335', 'P1336', 'P1337', 'P1338', 'P1339', 'P1340',
        'P1341', 'P1342', 'P1343', 'P1344', 'P1345', 'P1346', 'P1347', 'P1348', 'P1349', 'P1350',
        'P1351', 'P1352', 'P1353', 'P1354', 'P1355', 'P1356', 'P1357', 'P1358', 'P1359', 'P1360',
        'P1361', 'P1362', 'P1363', 'P1364', 'P1365', 'P1366', 'P1367', 'P1368', 'P1369', 'P1370',
        'P1371', 'P1372', 'P1373', 'P1374', 'P1375', 'P1376', 'P1377', 'P1378', 'P1379', 'P1380',
        'P1381', 'P1382', 'P1383', 'P1384', 'P1385', 'P1386', 'P1387', 'P1388', 'P1389', 'P1390',
        'P1391', 'P1392', 'P1393', 'P1394', 'P1395', 'P1396', 'P1397', 'P1398', 'P1399', 'P1400',
        'P1401', 'P1402', 'P1403', 'P1404', 'P1405', 'P1406', 'P1407', 'P1408', 'P1409', 'P1410',
        'P1411', 'P1412', 'P1413', 'P1414', 'P1415', 'P1416', 'P1417', 'P1418', 'P1419', 'P1420',
        'P1421', 'P1422', 'P1423', 'P1424', 'P1425', 'P1426', 'P1427', 'P1428', 'P1429', 'P1430',
        'P1431', 'P1432', 'P1433', 'P1434', 'P1435', 'P1436', 'P1437', 'P1438', 'P1439', 'P1440',
        'P1441', 'P1442', 'P1443', 'P1444', 'P1445', 'P1446', 'P1447', 'P1448', 'P1449', 'P1450',
        'P1451', 'P1452', 'P1453', 'P1454', 'P1455', 'P1456', 'P1457', 'P1458', 'P1459', 'P1460',
        'P1461', 'P1462', 'P1463', 'P1464', 'P1465', 'P1466', 'P1467', 'P1468', 'P1469', 'P1470',
        'P1471', 'P1472', 'P1473', 'P1474', 'P1475', 'P1476', 'P1477', 'P1478', 'P1479', 'P1480',
        'P1481', 'P1482', 'P1483', 'P1484', 'P1485', 'P1486', 'P1487', 'P1488', 'P1489', 'P1490',
        'P1491', 'P1492', 'P1493', 'P1494', 'P1495', 'P1496', 'P1497', 'P1498', 'P1499', 'P1500',
        'P1501', 'P1502', 'P1503', 'P1504', 'P1505', 'P1506', 'P1507', 'P1508', 'P1509', 'P1510',
        'P1511', 'P1512', 'P1513', 'P1514', 'P1515', 'P1516', 'P1517', 'P1518', 'P1519', 'P1520',
        'P1521', 'P1522', 'P1523', 'P1524', 'P1525', 'P1526', 'P1527', 'P1528', 'P1529', 'P1530',
        'P1531', 'P1532', 'P1533', 'P1534', 'P1535', 'P1536', 'P1537', 'P1538', 'P1539', 'P1540',
        'P1541', 'P1542', 'P1543', 'P1544', 'P1545', 'P1546', 'P1547', 'P1548', 'P1549', 'P1550',
        'P1551', 'P1552', 'P1553', 'P1554', 'P1555', 'P1556', 'P1557', 'P1558', 'P1559', 'P1560',
        'P1561', 'P1562', 'P1563', 'P1564', 'P1565', 'P1566', 'P1567', 'P1568', 'P1569', 'P1570',
        'P1571', 'P1572', 'P1573', 'P1574', 'P1575', 'P1576', 'P1577', 'P1578', 'P1579', 'P1580',
        'P1581', 'P1582', 'P1583', 'P1584', 'P1585', 'P1586', 'P1587', 'P1588', 'P1589', 'P1590',
        'P1591', 'P1592', 'P1593', 'P1594', 'P1595', 'P1596', 'P1597', 'P1598', 'P1599', 'P1600',
        'P1601', 'P1602', 'P1603', 'P1604', 'P1605', 'P1606', 'P1607', 'P1608', 'P1609', 'P1610',
        'P1611', 'P1612', 'P1613', 'P1614', 'P1615', 'P1616', 'P1617', 'P1618', 'P1619', 'P1620',
        'P1621', 'P1622', 'P1623', 'P1624', 'P1625', 'P1626', 'P1627', 'P1628', 'P1629', 'P1630',
        'P1631', 'P1632', 'P1633', 'P1634', 'P1635', 'P1636', 'P1637', 'P1638', 'P1639', 'P1640',
        'P1641', 'P1642', 'P1643', 'P1644', 'P1645', 'P1646', 'P1647', 'P1648', 'P1649', 'P1650',
        'P1651', 'P1652', 'P1653', 'P1654', 'P1655', 'P1656', 'P1657', 'P1658', 'P1659', 'P1660',
        'P1661', 'P1662', 'P1663', 'P1664', 'P1665', 'P1666', 'P1667', 'P1668', 'P1669', 'P1670',
        'P1671', 'P1672', 'P1673', 'P1674', 'P1675', 'P1676', 'P1677', 'P1678', 'P1679', 'P1680',
        'P1681', 'P1682', 'P1683', 'P1684', 'P1685', 'P1686', 'P1687', 'P1688', 'P1689', 'P1690',
        'P1691', 'P1692', 'P1693', 'P1694', 'P1695', 'P1696', 'P1697', 'P1698', 'P1699', 'P1700',
        'P1701', 'P1702', 'P1703', 'P1704', 'P1705', 'P1706', 'P1707', 'P1708', 'P1709', 'P1710',
        'P1711', 'P1712', 'P1713', 'P1714', 'P1715', 'P1716', 'P1717', 'P1718', 'P1719', 'P1720',
        'P1721', 'P1722', 'P1723', 'P1724', 'P1725', 'P1726', 'P1727', 'P1728', 'P1729', 'P1730',
        'P1731', 'P1732', 'P1733', 'P1734', 'P1735', 'P1736', 'P1737', 'P1738', 'P1739', 'P1740',
        'P1741', 'P1742', 'P1743', 'P1744', 'P1745', 'P1746', 'P1747', 'P1748', 'P1749', 'P1750',
        'P1751', 'P1752', 'P1753', 'P1754', 'P1755', 'P1756', 'P1757', 'P1758', 'P1759', 'P1760',
        'P1761', 'P1762', 'P1763', 'P1764', 'P1765', 'P1766', 'P1767', 'P1768', 'P1769', 'P1770',
        'P1771', 'P1772', 'P1773', 'P1774', 'P1775', 'P1776', 'P1777', 'P1778', 'P1779', 'P1780',
        'P1781', 'P1782', 'P1783', 'P1784', 'P1785', 'P1786', 'P1787', 'P1788', 'P1789', 'P1790',
        'P1791', 'P1792', 'P1793', 'P1794', 'P1795', 'P1796', 'P1797', 'P1798', 'P1799', 'P1800',
        'P1801', 'P1802', 'P1803', 'P1804', 'P1805', 'P1806', 'P1807', 'P1808', 'P1809', 'P1810',
        'P1811', 'P1812', 'P1813', 'P1814', 'P1815', 'P1816', 'P1817', 'P1818', 'P1819', 'P1820',
        'P1821', 'P1822', 'P1823', 'P1824', 'P1825', 'P1826', 'P1827', 'P1828', 'P1829', 'P1830',
        'P1831', 'P1832', 'P1833', 'P1834', 'P1835', 'P1836', 'P1837', 'P1838', 'P1839', 'P1840',
        'P1841', 'P1842', 'P1843', 'P1844', 'P1845', 'P1846', 'P1847', 'P1848', 'P1849', 'P1850',
        'P1851', 'P1852', 'P1853', 'P1854', 'P1855', 'P1856', 'P1857', 'P1858', 'P1859', 'P1860',
        'P1861', 'P1862', 'P1863', 'P1864', 'P1865', 'P1866', 'P1867', 'P1868', 'P1869', 'P1870',
        'P1871', 'P1872', 'P1873', 'P1874', 'P1875', 'P1876', 'P1877', 'P1878', 'P1879', 'P1880',
        'P1881', 'P1882', 'P1883', 'P1884', 'P1885', 'P1886', 'P1887', 'P1888', 'P1889', 'P1890',
        'P1891', 'P1892', 'P1893', 'P1894', 'P1895', 'P1896', 'P1897', 'P1898', 'P1899', 'P1900',
        'P1901', 'P1902', 'P1903', 'P1904', 'P1905', 'P1906', 'P1907', 'P1908', 'P1909', 'P1910',
        'P1911', 'P1912', 'P1913', 'P1914', 'P1915', 'P1916', 'P1917', 'P1918', 'P1919', 'P1920',
        'P1921', 'P1922', 'P1923', 'P1924', 'P1925', 'P1926', 'P1927', 'P1928', 'P1929', 'P1930',
        'P1931', 'P1932', 'P1933', 'P1934', 'P1935', 'P1936', 'P1937', 'P1938', 'P1939', 'P1940',
        'P1941', 'P1942', 'P1943', 'P1944', 'P1945', 'P1946', 'P1947', 'P1948', 'P1949', 'P1950',
        'P1951', 'P1952', 'P1953', 'P1954', 'P1955', 'P1956', 'P1957', 'P1958', 'P1959', 'P1960',
        'P1961', 'P1962', 'P1963', 'P1964', 'P1965', 'P1966', 'P1967', 'P1968', 'P1969', 'P1970',
        'P1971', 'P1972', 'P1973', 'P1974', 'P1975', 'P1976', 'P1977', 'P1978', 'P1979', 'P1980',
        'P1981', 'P1982', 'P1983', 'P1984', 'P1985', 'P1986', 'P1987', 'P1988', 'P1989', 'P1990',
        'P1991', 'P1992', 'P1993', 'P1994', 'P1995', 'P1996', 'P1997', 'P1998', 'P1999', 'P2000',
        'P2001', 'P2002', 'P2003', 'P2004', 'P2005', 'P2006', 'P2007', 'P2008', 'P2009', 'P2010',
        'P2011', 'P2012', 'P2013', 'P2014', 'P2015', 'P2016', 'P2017', 'P2018', 'P2019', 'P2020',
        'P2021', 'P2022', 'P2023', 'P2024', 'P2025', 'P2026', 'P2027', 'P2028', 'P2029', 'P2030',
        'P2031', 'P2032', 'P2033', 'P2034', 'P2035', 'P2036', 'P2037', 'P2038', 'P2039', 'P2040',
        'P2041', 'P2042', 'P2043', 'P2044', 'P2045', 'P2046', 'P2047', 'P2048', 'P2049', 'P2050',
        'P2051', 'P2052', 'P2053', 'P2054', 'P2055', 'P2056', 'P2057', 'P2058', 'P2059', 'P2060',
        'P2061', 'P2062', 'P2063', 'P2064', 'P2065', 'P2066', 'P2067', 'P2068', 'P2069', 'P2070',
        'P2071', 'P2072', 'P2073', 'P2074', 'P2075', 'P2076', 'P2077', 'P2078', 'P2079', 'P2080',
        'P2081', 'P2082', 'P2083', 'P2084', 'P2085', 'P2086', 'P2087', 'P2088', 'P2089', 'P2090',
        'P2091', 'P2092', 'P2093', 'P2094', 'P2095', 'P2096', 'P2097', 'P2098', 'P2099', 'P2100',
        'P2101', 'P2102', 'P2103', 'P2104', 'P2105', 'P2106', 'P2107', 'P2108', 'P2109', 'P2110',
        'P2111', 'P2112', 'P2113', 'P2114', 'P2115', 'P2116', 'P2117', 'P2118', 'P2119', 'P2120',
        'P2121', 'P2122', 'P2123', 'P2124', 'P2125', 'P2126', 'P2127', 'P2128', 'P2129', 'P2130',
        'P2131', 'P2132', 'P2133', 'P2134', 'P2135', 'P2136', 'P2137', 'P2138', 'P2139', 'P2140',
        'P2141', 'P2142', 'P2143', 'P2144', 'P2145', 'P2146', 'P2147', 'P2148', 'P2149', 'P2150',
        'P2151', 'P2152', 'P2153', 'P2154', 'P2155', 'P2156', 'P2157', 'P2158', 'P2159', 'P2160',
        'P2161', 'P2162', 'P2163', 'P2164', 'P2165', 'P2166', 'P2167', 'P2168', 'P2169', 'P2170',
        'P2171', 'P2172', 'P2173', 'P2174', 'P2175', 'P2176', 'P2177', 'P2178', 'P2179', 'P2180',
        'P2181', 'P2182', 'P2183', 'P2184', 'P2185', 'P2186', 'P2187', 'P2188', 'P2189', 'P2190',
        'P2191', 'P2192', 'P2193', 'P2194', 'P2195', 'P2196', 'P2197', 'P2198', 'P2199', 'P2200',
        'P2201', 'P2202', 'P2203', 'P2204', 'P2205', 'P2206', 'P2207', 'P2208', 'P2209', 'P2210',
        'P2211', 'P2212', 'P2213', 'P2214', 'P2215', 'P2216', 'P2217', 'P2218', 'P2219', 'P2220',
        'P2221', 'P2222', 'P2223', 'P2224', 'P2225', 'P2226', 'P2227', 'P2228', 'P2229', 'P2230',
        'P2231', 'P2232', 'P2233', 'P2234', 'P2235', 'P2236', 'P2237', 'P2238', 'P2239', 'P2240',
        'P2241', 'P2242', 'P2243', 'P2244', 'P2245', 'P2246', 'P2247', 'P2248', 'P2249', 'P2250',
        'P2251', 'P2252', 'P2253', 'P2254', 'P2255', 'P2256', 'P2257', 'P2258', 'P2259', 'P2260',
        'P2261', 'P2262', 'P2263', 'P2264', 'P2265', 'P2266', 'P2267', 'P2268', 'P2269', 'P2270',
        'P2271', 'P2272', 'P2273', 'P2274', 'P2275', 'P2276', 'P2277', 'P2278', 'P2279', 'P2280',
        'P2281', 'P2282', 'P2283', 'P2284', 'P2285', 'P2286', 'P2287', 'P2288', 'P2289', 'P2290',
        'P2291', 'P2292', 'P2293', 'P2294', 'P2295', 'P2296', 'P2297', 'P2298', 'P2299', 'P2300',
        'P2301', 'P2302', 'P2303', 'P2304', 'P2305', 'P2306', 'P2307', 'P2308', 'P2309', 'P2310',
        'P2311', 'P2312', 'P2313', 'P2314', 'P2315', 'P2316', 'P2317', 'P2318', 'P2319', 'P2320',
        'P2321', 'P2322', 'P2323', 'P2324', 'P2325', 'P2326', 'P2327', 'P2328', 'P2329', 'P2330',
        'P2331', 'P2332', 'P2333', 'P2334', 'P2335', 'P2336', 'P2337', 'P2338', 'P2339', 'P2340',
        'P2341', 'P2342', 'P2343', 'P2344', 'P2345', 'P2346', 'P2347', 'P2348', 'P2349', 'P2350',
        'P2351', 'P2352', 'P2353', 'P2354', 'P2355', 'P2356', 'P2357', 'P2358', 'P2359', 'P2360',
        'P2361', 'P2362', 'P2363', 'P2364', 'P2365', 'P2366', 'P2367', 'P2368', 'P2369', 'P2370',
        'P2371', 'P2372', 'P2373', 'P2374', 'P2375', 'P2376', 'P2377', 'P2378', 'P2379', 'P2380',
        'P2381', 'P2382', 'P2383', 'P2384', 'P2385', 'P2386', 'P2387', 'P2388', 'P2389', 'P2390',
        'P2391', 'P2392', 'P2393', 'P2394', 'P2395', 'P2396', 'P2397', 'P2398', 'P2399', 'P2400'
    ]

    io = 'target'
    for p_ind, patient_id in enumerate(patient_ids):
        print(f"Processing patient: {patient_id}")
        if p_ind >= 0:
            patient_path = osp.join(args.data_path, patient_id, 'sta')
            data_paths = natsorted(glob(osp.join(patient_path, '*.tif')))
            for data_path in data_paths:
                f = tiff.imread(data_path)  # 读取为 3D 数组

                print(f"Padded shape of the file '{data_path}': {f.shape}")
                f_name = '{}_{}_tif.npy'.format(patient_id, io)
                np.save(osp.join(args.save_path, f_name), f.astype(np.uint16))  # 保存为 .npy 文件

    io = '16cg'
    for p_ind, patient_id in enumerate(patient_ids):
        print(f"Processing patient: {patient_id}")
        if p_ind >= 0:
            patient_path = osp.join(args.data_path, patient_id, '16cg')
            data_paths = natsorted(glob(osp.join(patient_path, '*.tif')))
            for data_path in data_paths:
                f = tiff.imread(data_path)  # 读取为 3D 数组

                print(f"Padded shape of the file '{data_path}': {f.shape}")
                f_name = '{}_{}_tif.npy'.format(patient_id, io)
                np.save(osp.join(args.save_path, f_name), f.astype(np.uint16))  # 保存为 .npy 文件


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument('--data_path', type=str, default='../../BDM_16cg')   # 数据路径
    parser.add_argument('--save_path', type=str, default='./gen_data/spect_16cg_npy/')  # 保存路径
    args = parser.parse_args()
    save_dataset(args)